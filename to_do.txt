- в блоке create контроллера заказов неопределен метод `current_cart`

- перевести подтверждение о заказе в сообщении почты.

- при смене локали исчезает форма заказа

- уменьшить ширину #side если корзина пуста

- кнопку удалить из товарной позиции перевести на Аякс

- попробовать сделать шаблон `product` для всех представлений

- удалить шаблон _form_search из представлений, где он использовался до перемещения в laoyuts



сначала написал функцию в хелпере

  def currencyRate(price)
    return case I18n.locale.to_s
           when 'en' then price
           when 'es' then price * 0.9
           when 'ua' then price * 22
           else price
           end
  end

и во вьюхе заменил:
  Product price: <%= number_to_currency(@product.price ) %>
на
  Product price: <%= number_to_currency(currencyRate(@product.price)  %>

Этот способ работает, но нужно менять код во всех вьюхах



потом попробовал написать отдельный метод в классе:
class Product < ActiveRecord::Base

  def self.localPrice
    case I18n.locale.to_s
      when 'en' then self.price
      when 'es' then self.price * 0.9
      when 'ua' then self.price * 22
      else self.price
    end
  end

end

и во вьюхе заменил на
  Product price: <%= @product.localPrice  %>

Тут выдает ошибку: "undefined method `localPrice' for #<Product:0xb4fbc87c>"
Но даже если бы и не было бы ошибки, все равно ведь пришлось снова искать все вьюхи, где стоит сейчас `@product.price'
Собственно вопрос: "А как в магазинах реализовывают различные курсы?" Видел магазины, где цена кроме курса еще и от способа оплаты зависит.

